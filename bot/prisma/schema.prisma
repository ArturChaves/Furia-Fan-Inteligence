generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Fan {
  id                   String   @id @default(uuid())
  whatsapp_number      String   @unique
  nome                 String
  cidade               String
  cpf                  String?  // opcional
  prefere_alerta_jogos Boolean  @default(false)
  prefere_novidades    Boolean  @default(false)
  redes_sociais        Json?
  created_at           DateTime @default(now())

  interactions Interaction[]
  notifications Notification[]
  fanSegments   FanSegment[]
}

model Interaction {
  id        String   @id @default(uuid())
  fan       Fan      @relation(fields: [fanId], references: [id])
  fanId     String
  content   String
  createdAt DateTime @default(now())
}

model Notification {
  id        String   @id @default(uuid())
  fan       Fan      @relation(fields: [fanId], references: [id])
  fanId     String
  type      String
  status    String
  createdAt DateTime @default(now())
}

model FanSegment {
  id        String   @id @default(uuid())
  fan       Fan      @relation(fields: [fanId], references: [id])
  fanId     String
  cluster   String
  createdAt DateTime @default(now())
}

model KPIReport {
  id             String   @id @default(uuid())
  data           DateTime
  total_fans     Int
  opt_in_jogos   Float
  opt_in_promo   Float
  engajamento    Float
  createdAt      DateTime @default(now())
}
